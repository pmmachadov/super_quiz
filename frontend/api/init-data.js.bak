import { initDefaultQuizzes } from "../../lib/json-db.mjs";

export default async function handler(req, res) {
  if (req.method !== "POST") return res.status(405).json({ error: "Method not allowed" });

  try {
    const defaultQuizzes = [
      {
        title: "Basic Programming",
        description: "Conceptos fundamentales de programación",
        category: "tecnologia",
        difficulty: "easy",
        timeLimit: 45,
        questions: [
          {
            question: "What does HTML stand for?",
            options: [
              "Hyper Text Markup Language",
              "High Tech Modern Language",
              "Hyper Technical Machine Learning",
              "Home Tool Markup Language",
            ],
            correctAnswer: 0,
          },
        ],
      },
      {
        title: "Advanced JavaScript",
        description: "Conceptos avanzados de JavaScript moderno",
        category: "tecnologia",
        difficulty: "hard",
        timeLimit: 45,
        questions: [
          {
            question: "What is a Promise in JavaScript?",
            options: [
              "A type of variable",
              "An object that represents a value that may be available now, in the future, or never",
              "A built-in function",
              "A type of loop",
            ],
            correctAnswer: 1,
          },
        ],
      },
    ];

    const result = initDefaultQuizzes(defaultQuizzes);
    if (result.message === "exists") {
      return res.status(200).json({ message: `Base de datos ya tiene ${result.count} quizzes`, count: result.count });
    }
    return res.status(200).json({ message: `✅ ${result.count} quizzes inicializados correctamente`, count: result.count });
  } catch (error) {
    console.error("Error inicializando datos:", error);
    return res.status(500).json({ error: "Error inicializando la base de datos", details: error.message });
  }
}
